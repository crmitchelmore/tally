{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://tally-tracker.app/schemas/shared-types.schema.json",
  "title": "Tally Shared Types",
  "description": "Cross-platform API contract definitions for Tally. DTOs use 'id' (not '_id').",
  "type": "object",
  "$defs": {
    "TimeframeUnit": {
      "type": "string",
      "enum": ["year", "month", "custom"]
    },
    "FeelingType": {
      "type": "string",
      "enum": ["very-easy", "easy", "moderate", "hard", "very-hard"]
    },
    "PaceStatus": {
      "type": "string",
      "enum": ["ahead", "onPace", "behind"]
    },
    "UserDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "clerkId", "createdAt"],
      "properties": {
        "id": { "type": "string" },
        "clerkId": { "type": "string" },
        "email": { "type": "string" },
        "name": { "type": "string" },
        "avatarUrl": { "type": "string" },
        "createdAt": { "type": "number" }
      }
    },
    "ChallengeDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "id",
        "userId",
        "name",
        "targetNumber",
        "year",
        "color",
        "icon",
        "timeframeUnit",
        "isPublic",
        "archived",
        "createdAt"
      ],
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "name": { "type": "string" },
        "targetNumber": { "type": "number" },
        "year": { "type": "number" },
        "color": { "type": "string" },
        "icon": { "type": "string" },
        "timeframeUnit": { "$ref": "#/$defs/TimeframeUnit" },
        "startDate": { "type": "string" },
        "endDate": { "type": "string" },
        "isPublic": { "type": "boolean" },
        "archived": { "type": "boolean" },
        "createdAt": { "type": "number" }
      }
    },
    "EntrySetDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": ["reps"],
      "properties": {
        "reps": { "type": "number" }
      }
    },
    "EntryDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "userId", "challengeId", "date", "count", "createdAt"],
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "challengeId": { "type": "string" },
        "date": { "type": "string" },
        "count": { "type": "number" },
        "note": { "type": "string" },
        "sets": {
          "type": "array",
          "items": { "$ref": "#/$defs/EntrySetDTO" }
        },
        "feeling": { "$ref": "#/$defs/FeelingType" },
        "createdAt": { "type": "number" }
      }
    },
    "FollowedChallengeDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "userId", "challengeId", "followedAt"],
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "challengeId": { "type": "string" },
        "followedAt": { "type": "number" }
      }
    },
    "ChallengeStatsDTO": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "total",
        "remaining",
        "daysLeft",
        "requiredPerDay",
        "currentStreak",
        "longestStreak",
        "averagePerDay",
        "daysActive",
        "paceStatus",
        "paceOffset"
      ],
      "properties": {
        "total": { "type": "number" },
        "remaining": { "type": "number" },
        "daysLeft": { "type": "number" },
        "requiredPerDay": { "type": "number" },
        "currentStreak": { "type": "number" },
        "longestStreak": { "type": "number" },
        "bestDay": {
          "oneOf": [
            { "type": "null" },
            {
              "type": "object",
              "required": ["date", "count"],
              "properties": {
                "date": { "type": "string" },
                "count": { "type": "number" }
              }
            }
          ]
        },
        "averagePerDay": { "type": "number" },
        "daysActive": { "type": "number" },
        "paceStatus": { "$ref": "#/$defs/PaceStatus" },
        "paceOffset": { "type": "number" }
      }
    },
    "ErrorResponse": {
      "type": "object",
      "additionalProperties": false,
      "required": ["error"],
      "properties": {
        "error": { "type": "string" }
      }
    },
    "SuccessResponse": {
      "type": "object",
      "additionalProperties": false,
      "required": ["success"],
      "properties": {
        "success": { "const": true }
      }
    },
    "CreateResponse": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id"],
      "properties": {
        "id": { "type": "string" }
      }
    }
  }
}
